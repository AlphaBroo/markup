# Vue.js概述

[参考](https://cn.vuejs.org/v2/guide/installation.html)

Vue.js（读音 /vjuː/, 类似于 view） 是一套构建用户界面的渐进式框架。

Vue 只关注视图层， 采用自底向上增量开发的设计。

Vue 的目标是通过尽可能简单的 API 实现响应的数据绑定和组合的视图组件。

## 安装

- 独立版本

```
在 Vue.js 的官网上直接下载 vue.min.js 并用 <script> 标签引入。
<script src="/static/js/vue.js"></script>
```

- 网络版本

```
BootCDN（国内） : https://cdn.bootcss.com/vue/2.2.2/vue.min.js

unpkg：https://unpkg.com/vue/dist/vue.js, 会保持和 npm 发布的最新的版本一致。

cdnjs : https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.8/vue.min.js
```

- NPM方法

> 安装Node版本管理工具

```
// 版本管理工具
brew install nvm
nvm ls-remote // 查看可安装版本
nvm ls // 列出可安装版本
nvm install xxx // 安装可用版本
nvm use xxx // 切换版本
nvm run 4.2.2 --version // 直接运行特定版本的 Node
nvm exec 4.2.2 node --version //在当前终端的子进程中运行特定版本的 Node
nvm which 4.2.2 //确认某个版本Node的路径

//从特定版本导入到我们将要安装的新版本 Node：
nvm install v5.0.0 --reinstall-packages-from=4.2
```

> 安装vue

```
// 安装node.js
brew install node
// 使用淘宝镜像
$ npm install -g cnpm --registry=https://registry.npm.taobao.org

// 安装vue
$ cnpm install vue
```

## 命令行

Vue.js 提供一个官方命令行工具，可用于快速搭建大型单页应用。

```
# 全局安装 vue-cli
$ cnpm install --global vue-cli
# 创建一个基于 webpack 模板的新项目(项目名不能大写)
$ vue init webpack my-project
# 这里需要进行一些配置，默认回车即可
...
```

进入项目，安装并运行

```
$ cd my-project
$ cnpm install
$ cnpm run dev
```

## 目录结构

使用npm安装项目，则目录结构汇总包含如下

| 目录/文件    | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| build        | 项目构建(webpack)相关代码                                    |
| config       | 配置目录，包括端口号等                                       |
| node_modules | npm加载的项目依赖模块                                        |
| src          | 开发目录，包括：<br>assets:放置一些图片，如logo等<br>components:目录里面放了一个组件文件，可以不用<br>App.vue：项目入口文件，可以直接将组件写在这里，二不适用components目录<br>main.js:项目的核心文件 |
| static       | 静态资源目录，如图片、字体等                                 |
| test         | 初始测试目录，可删除                                         |
| .xxx文件     | 配置文件，包括语法配置，git配置等                            |
| index.html   | 首页入口文件，可添加一些meta信息或统计代码                   |
| package.json | 项目配置文件                                                 |
| README.md    | 项目说明文档                                                 |

## 实例

每个 Vue 应用都是通过用 `Vue` 函数创建一个新的 **Vue 实例**开始的

当一个 Vue 实例被创建时，它向 Vue 的响应式系统中加入了其 data 对象中能找到的所有的属性。当这些属性的值发生改变时，html 视图将也会产生相应的变化。

```
var vm = new Vue({
    //选项
})
```

> 构造器

```html
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Vue 测试实例 - 菜鸟教程(runoob.com)</title>
	<script src="https://cdn.staticfile.org/vue/2.4.2/vue.min.js"></script>
</head>
<body>
	<div id="vue_det">
		<h1>site : {{site}}</h1>
		<h1>url : {{url}}</h1>
		<h1>{{details()}}</h1>
	</div>
	<script type="text/javascript">
		var vm = new Vue({
			el: '#vue_det',
			data: {
				site: "菜鸟教程",
				url: "www.runoob.com",
				alexa: "10000"
			},
			methods: {
				details: function() {
					return  this.site + " - 学的不仅是技术，更是梦想！";
				}
			}
		})
	</script>
```

构造器参数

```javascript
el
// 是DOM元素中的id,表示接下来的改动全部在以上指定的div内，div外部不受影响
data
// 用于定义属性
methods
// 用于定义的函数，可以通过return来返回函数值
{{}}
// 用于输出对象属性和函数返回值
```

> 其他属性

除了数据属性，Vue 实例还提供了一些有用的实例属性与方法。它们都有前缀 $，以便与用户定义的属性区分开来

```html
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Vue 测试实例 - 菜鸟教程(runoob.com)</title>
	<script src="https://cdn.staticfile.org/vue/2.4.2/vue.min.js"></script>
</head>
<body>
	<div id="vue_det">
		<h1>site : {{site}}</h1>
		<h1>url : {{url}}</h1>
		<h1>Alexa : {{alexa}}</h1>
	</div>
	<script type="text/javascript">
	// 我们的数据对象
	var data = { site: "菜鸟教程", url: "www.runoob.com", alexa: 10000}
	var vm = new Vue({
		el: '#vue_det',
		data: data
	})
	// vue实例的属性与方法
	document.write(vm.$data === data) // true
	document.write(vm.$el === document.getElementById('vue_det')) // true
  // $watch 是一个实例方法
	vm.$watch('a', function (newValue, oldValue) {
    // 这个回调将在 `vm.a` 改变后调用
	})
	// 它们引用相同的对象！
	document.write(vm.site === data.site) // true
	// 设置属性也会影响到原始数据
	vm.site = "Runoob"
	document.write(data.site + "<br>") // Runoob
 
	// ……反之亦然
	data.alexa = 1234
	document.write(vm.alexa) // 1234	
	</script>
</body>
</html>
```

## 生命周期

- 生命周期钩子

| vue2.0        | desc                                                         |
| ------------- | ------------------------------------------------------------ |
| beforeCreate  | 组件实例刚被创建，组件属性计算之前，如data属性还未初始化     |
| created       | 组件示例刚创建完成，属性已绑定，但DOM还未生成，`$el`属性还不存在 |
| beforeMount   | 模版编译/挂载之前，使用虚拟DOM，占位不传值                   |
| mounted       | 模版编译/挂载之后                                            |
| beforeUpdate  | 组件更新之前                                                 |
| updated       | 组件更新之后                                                 |
| activated     | for`keep-alive`，组件被激活时调用                            |
| deactivated   | for`keep-alive`，组件被移除时调用                            |
| beforeDestory | 组件销毁前调用                                               |
| Destroyed     | 组件销毁后调用                                               |

<img src="https://cn.vuejs.org/images/lifecycle.png" alt="lifecycle" style="zoom:50%;" />

- 示例代码

```html
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/vue/2.1.3/vue.js"></script>
</head>
<body>

<div id="app">
     <p>{{ message }}</p>
</div>

<script type="text/javascript">
    
  var app = new Vue({
      el: '#app',
      data: {
          message : "xuxiao is boy" 
      },
       beforeCreate: function () {
                console.group('beforeCreate 创建前状态===============》');
               console.log("%c%s", "color:red" , "el     : " + this.$el); //undefined
               console.log("%c%s", "color:red","data   : " + this.$data); //undefined 
               console.log("%c%s", "color:red","message: " + this.message)  
        },
        created: function () {
            console.group('created 创建完毕状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el); //undefined
               console.log("%c%s", "color:red","data   : " + this.$data); //已被初始化 
               console.log("%c%s", "color:red","message: " + this.message); //已被初始化
        },
        beforeMount: function () {
            console.group('beforeMount 挂载前状态===============》');
            console.log("%c%s", "color:red","el     : " + (this.$el)); //已被初始化
            console.log(this.$el);
               console.log("%c%s", "color:red","data   : " + this.$data); //已被初始化  
               console.log("%c%s", "color:red","message: " + this.message); //已被初始化  
        },
        mounted: function () {
            console.group('mounted 挂载结束状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el); //已被初始化
            console.log(this.$el);    
               console.log("%c%s", "color:red","data   : " + this.$data); //已被初始化
               console.log("%c%s", "color:red","message: " + this.message); //已被初始化 
        },
        beforeUpdate: function () {
            console.group('beforeUpdate 更新前状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el);   
               console.log("%c%s", "color:red","data   : " + this.$data); 
               console.log("%c%s", "color:red","message: " + this.message); 
        },
        updated: function () {
            console.group('updated 更新完成状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el); 
               console.log("%c%s", "color:red","data   : " + this.$data); 
               console.log("%c%s", "color:red","message: " + this.message); 
        },
        beforeDestroy: function () {
            console.group('beforeDestroy 销毁前状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el);    
               console.log("%c%s", "color:red","data   : " + this.$data); 
               console.log("%c%s", "color:red","message: " + this.message); 
        },
        destroyed: function () {
            console.group('destroyed 销毁完成状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el);  
               console.log("%c%s", "color:red","data   : " + this.$data); 
               console.log("%c%s", "color:red","message: " + this.message)
        }
    })
</script>
</body>
</html>
```

打开F12可直接查看`create`和`mounted`相关的加载情况

> `beforecreated`：el 和 data 并未初始化
> `created`:完成了 data 数据的初始化，el没有
> `beforeMount`：完成了 el 和 data 初始化
> `mounted` ：完成挂载
>
> 另外在标红处，我们能发现el还是 {{message}}，这里就是应用的 `Virtual DOM`（虚拟Dom）技术，先把坑占住了。到后面`mounted`挂载的时候再把值渲染进去。

在console中执行

```
app.message= 'yes !! I do';
```

下面就能看到data里的值被修改后，将会触发update的操作。

在console中执行

```
app.$destroy();
```

销毁完成后，我们再重新改变message的值，vue不再对此动作进行响应了。但是原先生成的dom元素还存在，可以这么理解，执行了destroy操作，后续就不再受vue控制了。

- 使用

`beforecreate` : 举个栗子：可以在这加个loading事件

`created` ：在这结束loading，还做一些初始化，实现函数自执行

`mounted` ： 在这发起后端请求，拿回数据，配合路由钩子做一些事情

`beforeDestroy`： 你确认删除XX吗？ 

`destroyed` ：当前组件已被删除，清空相关内容

> 注意
>
> 不要在选项属性或回调上使用[箭头函数](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions)，比如 `created: () => console.log(this.a)` 或 `vm.$watch('a', newValue => this.myMethod())`。因为箭头函数并没有 `this`，`this` 会作为变量一直向上级词法作用域查找，直至找到为止，经常导致 `Uncaught TypeError: Cannot read property of undefined` 或 `Uncaught TypeError: this.myMethod is not a function` 之类的错误。

