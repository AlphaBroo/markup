# 方案一

历史计算、剩余额度、临时变更

消费额度管理

| key          | Type | desc                         |
| ------------ | ---- | ---------------------------- |
| user_id      |      | 加盟商id                     |
| sumMoney     |      | 消费总金额                   |
| historyMoney |      | 上次计算时的消费总金额       |
| usedMoney    |      | 上次计算处理过的金额         |
| leftMoney    |      | 上次计算时剩余暂不处理的金额 |
| currentMoney |      | 上次计算后新产生的金额       |

计算赠送处理记录

| key        | Type | Desc       |
| ---------- | ---- | ---------- |
| perMoney   |      | 优惠价     |
| perQuota   |      | 优惠名额数 |
| updateTime |      | 变更时间   |

# 方案二

give_quota

| key                  | type | desc |
| -------------------- | ---- | ---- |
| id                   |      |      |
| user_id              |      |      |
| total_money          |      |      |
| last_remaining_money |      |      |
| new_money            |      |      |
| used_money           |      |      |
| quota_numbers        |      |      |
| remain_monry         |      |      |
| create_time          |      |      |

