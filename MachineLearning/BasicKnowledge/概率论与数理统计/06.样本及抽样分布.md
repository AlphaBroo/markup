# 样本及抽样分布

## 随机样本 

在梳理统计中，我们往往研究有关对象的某一项数量指标。为此，考虑与这一数量指标相联系的随机试验，对这一数量指标进行试验或观察。我们将试验的全部可能的观察值称为**总体**，这些值不一定都不相同，数目上也不一定是有限的，每一个可能观察值称为**个体**。总体中所包含的个体的个数称为总体的**容量**。容量为有限的称为**有限总体**，容量为无限的称为**无限总体**。

> 定义

设 $X$ 是具有分布函数 $F$ 的随机变量，若 $X_1,X_2,...,X_n$ 是具有同一分布函数 $F$ 的、相互独立的随机变量，则称 $X_1,X_2,...,X_n$ 为从分布函数 $F$ （或总体 $F$、或总体 $X$）得到的**容量为 $n$ 的简单随机样本**，简称**样本**，它们的观察值 $x_1,x_2,...,x_n$ 称为**样本值**，又称为 $X$ 的 $n$ 个**独立的观察值**

由定义得，若 $X_1,X_2,...,X_n$ 为 $F$ 的一个样本，则 $X_1,X_2,...,X_N$ 相互独立，且它们的分布函数都是 $F$，所以 $(X_1,X_2,...,X_n)$ 的分布函数为
$$
F^*(x_1,x_2,...,x_n) = \prod_{i=1}^{n}{F(x_i)}
$$
又若 $X$ 具有概率密度 $f$，则 $(X_1,X_2,...,X_n)$ 的概率密度为
$$
f^*(x_1,x_2,...,x_n) = \prod_{i=1}^{n}{f(x_i)}
$$

## 抽样分布

**定义**

设 $X_1,X_2,...,X_n$ 是来自总体 $X$ 的一个样本，$g(X_1,X_2,...,X_n)$ 是 $X_1,X_2,...,X_n$ 的函数，若 $g$ 中不含未知参数，则称 $g(X_1,X_2,...,X_n)$ 是一**统计量**

因为 $X_1,X_2,...,X_n$ 都是随机变量，而统计量 $g(X_1,X_2,...,X_n)$ 是随机变量的函数，因此统计量是一个随机变量，设 $x_1,x_2,...x_n$ 是相应于样本 $X_1，X_2,...,X_n$ 的样本值，则称 $g(x_1,x_2,...,x_n)$ 是 $g(X_1,X_2,...,X_n)$ 的观察值

常用统计量

设 $X_1,X_2,...,X_n$ 是来自总体 $X$ 的一个样本，$x_1,x_2,...,x_n$ 是这一样本的观察值，定义

**样本平均值**
$$
\bar{X} = \frac{1}{n}\sum_{i=1}^{n}{X_i}
$$
**样本方差**
$$
S^2 = \frac{1}{n-1}\sum_{i=1}^{n}{(X_i-\bar{X})^2}=\frac{1}{n-1}{(\sum_{i=1}^{n}{X_i^2}-n\bar{X}^2)}
$$
**样本标准差**
$$
S = \sqrt{S^2} = \sqrt{\frac{1}{n-1}\sum_{i=1}^{n}{(X_i-\bar{X})^2}}
$$


**样本 $k$ 阶(原点)矩 **
$$
A_k = \frac{1}{n}\sum_{i=1}^{n}{X_i^k},k=1,2,...
$$
**样本 $k$ 阶中心矩**
$$
B_k = \frac{1}{n}\sum_{i=1}^{n}{(X_i-\bar{X})^k},k=2,3,...
$$
它们的观察值分别为
$$
\bar{x} = \frac{1}{n}\sum_{i=1}^{n}{x_i} \\
s^2 = \frac{1}{n-1}\sum_{i=1}^{n}{(x_i-\bar{x})^2}=\frac{1}{n-1}{(\sum_{i=1}^{n}{x_i^2}-n\bar{x}^2)}\\
s = \sqrt{s^2} = \sqrt{\frac{1}{n-1}\sum_{i=1}^{n}{(x_i-\bar{x})^2}}\\
a_k = \frac{1}{n}\sum_{i=1}^{n}{x_i^k},k=1,2,...\\
b_k = \frac{1}{n}\sum_{i=1}^{n}{(x_i-\bar{x})^k},k=2,3,...
$$
这些观察值仍分别称为样本均值、样本方差、样本标准差、样本k阶（原点）矩以及样本k阶中心矩。

若总体 $X$ 的 $k$ 阶矩 $E(X^k)\stackrel{记作}{=}\mu_k$ 存在，则当 $n\rightarrow\infty$ 时，$A_k\stackrel{P}{\longrightarrow}\mu_k,k=1,2,...$

依概率收敛的序列的性质知道，对于连续函数 $g$
$$
g(A_1,A_2,..,A_k)\stackrel{P}{\longrightarrow}g(\mu_1,\mu_2,...,\mu_k)
$$
**经验分布函数**

与总体分布函数 $F(x)$ 相应的统计量-经验分布函数。它的做法如下：设 $X_1,X_2,...X_n$ 是总体 $F$ 的一个样本，用 $S(x), -\infty<x<\infty$ 表示 $X_1,X_2,...,X_n$ 中不大于 $x$ 的随机变量的个数。定义经验分布函数 $F_n(x)$ 为
$$
F_n(x) = \frac{1}{n}{S(x)}, -\infty<x<\infty
$$
一般，设 $x$ 是总体 $F$ 的一个容量为 $n$ 的样本值，先将 $x_1,x_2,...,x_n$ 按照自小到大的次序排列，并重新编号，设为
$$
x_{(1)}\leq{x_{(2)}}\leq{...}\leq{x_{(n)}}
$$
则经验分布函数 $F_n(x)$ 的观察值为
$$
F_n(x) = \begin{cases}
0, & 若x<x_{(1)},\\
\frac{k}{n}, & 若x_{(k)}\leq{x}<x_{(k+1)},k=1,2,...,n-1,\\
1, & 若x\geq{x_{(n)}}
\end{cases}
$$
对于经验分布函数 $F_n(x)$，有结论：对于任意实数 $x$，当 $n\rightarrow\infty$ 时 $F_n(x)$ 以概率1一致收敛于分布函数 $F(x)$，即
$$
P\{\lim_{n\rightarrow\infty}\sup_{-\infty<x<\infty}|F_n(x)-F(x)|=0\} = 1
$$
因此，对于任一实数 $x$ 当 $n$ 充分大时，经验分布函数的任一观察值 $F_n(x)$ 与总体分布函数 $F(x)$ 只有微小的差别，从而在实际上可当作 $F(x)$ 来使用。

统计量的分布称为**抽样分布**。在使用统计量进行统计推断时长需知道她的分布，当总体的分布函数已知时，抽样分布是确定的，然而要求出统计量的精确分布，一般来说是困难的

- 来自正态总体的常用统计量的分布

> $\chi^2$分布

设 $X_1,X_2,...X_n$ 是来自总体 $N(0,1)$ 的样本，则统计量
$$
\chi^2 = X_1^2+X_2^2+\cdots+X_n^2
$$
服从自由度为 $n$ 的 $\chi^2$ 分布，记为 $\chi^2\sim{\chi^2(n)}$

自由度指的是右端包含的独立变量的个数

$\chi^2(n)$ 分布的概率密度为
$$
f(y)=\begin{cases}
\frac{1}{2^{n/2}\Gamma(n/2)}{y^{n/2-1}e^{-y/2}}, & y>0,  \\
0, & 其他
\end{cases}
$$
由 $\Gamma$ 分布的可加性知
$$
\chi^2 = \sum_{i=1}^{n}{X_i^2}\sim{\Gamma(\frac{n}{2}, 2)}
$$
易得 $\chi^2$ 的可加性如下：

**$\chi^2$分布的可加性**

设  $\chi_1^2\sim{\chi^2(n_1)},\chi_2^2\sim{\chi^2(n_2)}$，并且 $\chi_1^2,\chi_2^2$相互独立，则有
$$
\chi_1^2 + \chi_2^2 \sim \chi^2(n_1+n_2)
$$
**$\chi^2$分布的数学寄望和方差**

若 $\chi^2\sim{\chi^2(n)}$，则有
$$
E(\chi^2) = n, D(\chi^2) = 2n
$$
**$\chi^2$分布的分位点**

对于给定的正 $\alpha,0<a<1$，满足条件
$$
P\{\chi^2>\chi_{\alpha}^2(n)\}=\int_{\chi_{\alpha}^{2}(n)}^{\infty}{f(y)\mathrm{d}y}=\alpha
$$
的点 $\chi_{\alpha}^{2}(n)$ 就是 $\chi^2(n)$分布的上 $\alpha$ 分位点。

当 $n$充分大时，近似地有 
$$
\chi_{\alpha}^{2}{(n)}\approx{\frac{1}{2}{(z_{\alpha}+\sqrt{2n-1})^2}}
$$
其中 $z_{\alpha}$ 是标准正态分布上 $\alpha	$ 分位点。

> $t$分布

设 $X\sim{N(0,1)},Y\sim{\chi^2(n)}$，且 $X,Y$ 相互独立，则称随机变量
$$
t = \frac{X}{\sqrt{Y/n}}
$$
服从自由度为 $n$ 的**$t$分布**，记为 $t\sim{t(n)}$。$t$分布又称**学生氏分布** 。

$t(n)$ 分布的概率密度函数为
$$
h(t) = \frac{\Gamma[(n+1)/2]}{\sqrt{\pi{n}}\Gamma(n/2)}{(1+\frac{t^2}{n})^{-(n+1)/2}}, -\infty<t<\infty
$$
**$t$分布上的分位点**

对于给定的 $\alpha,0<\alpha<1$，满足条件
$$
P\{t>t_{\alpha}(n)\} = \int_{t_{\alpha}(n)}^{\infty}{h(t)\mathrm{d}t}=\alpha
$$
的点  $t_{\alpha}(n)$ 就是 $t(n)$ 分布上 $\alpha$ 分位点。

由 $t$ 分布上 $\alpha$ 分位点的定义及 $h(t)$ 图形的对称性知
$$
t_{1-\alpha}(n)=-t_{\alpha}(n)
$$
在 $n>45$ 时，对于常用的 $\alpha$ 的值，可以用正态近似
$$
t_{\alpha}(n) = z_{\alpha}
$$

> $F$ 分布

设 $U\sim\chi^2(n_1),V\sim{\chi^2(n_2)}$，且 $U,V$相互独立，则称随机变量 
$$
F = \frac{U/n_1}{V/n_2}
$$
服从自由度为 $(n_1,n_2)$ 的**$F$分布**，记为 $F\sim{F(n_1,n_2)}$

$F(n_1,n_2)$分布的概率密度为
$$
\psi(y) = \begin{cases}
\frac{\Gamma[(n_1+n_2)/2](n_1/n_2)^{n_1/2}y^{(n_1/2)-1}}{\Gamma(n_1/2)\Gamma(n_2/2)[1+(n_1y/n_2)]^{(n_1+n_2)/2}}, & y>0,\\
0, & 其他
\end{cases}
$$
由定义可知，若 $F\sim{F(n_1,n_2)}$，则
$$
\frac{1}{F}\sim{F(n_2,n_1)}
$$
**$F$分布的上分位点**

对于给定的 $\alpha, 0<\alpha<1$，满足条件
$$
P\{F>F_{\alpha}(n_1,n_2)\} = \int_{F_{\alpha(n_1,n_2)}}^{\infty}{\psi(y)\mathrm{d}y} = \alpha
$$
的点 $F_{\alpha}(n_1,n_2)$ 就是  $F(n_1,n_2)$ 分布的上 $\alpha$ 分位点。

有如下性质：
$$
F_{1-\alpha}(n_1,n_2) = \frac{1}{F_{\alpha}(n_2,n_1)}
$$

> 正态总体的样本均值与样本方差的分布

设总体 $X$ （不管服从什么分布，只要均值和方差存在）的均值为 $\mu$，方差为 $\sigma^2$，$X_1,X_2,...,X_n$ 是来自 $X$ 的一个样本，$\bar{X},S^2$分别是样本均值和样本方差，则有
$$
E(\bar{X}) = \mu, D(\bar{X})=\sigma^2/n
$$
而
$$
\begin{align*}
E(S^2)
&= E[\frac{1}{n-1}(\sum_{i=1}^{n}{X_i^2}-n\bar{X}^2)]\\
&= \frac{1}{n-1}[\sum_{i=1}^{n}{E(X_i^2)}-nE(\bar{X}^2)]\\
&= \frac{1}{n-1}[\sum_{i=1}^{n}{(\sigma^2+\mu^2)}-n(\sigma^2/n+\mu^2)]\\
&= \sigma^2
\end{align*}
$$
设 $X\sim{N(\mu,\sigma^2)}$，则 $\bar{X}=\frac{1}{n}{\sum_{i=1}^{n}{X_i}}$ 也服从正态分布。得到如下定理

**定理一**

设 $X_1,X_2,...,X_n$ 是来自正态总体 $N(\mu,\sigma^2)$ 的样本，$\bar{X}$ 是样本均值，则有
$$
\bar{X} \sim{N(\mu,\sigma^2/n)}
$$

**定理二**

设 $X_1,X_2,...,X_n$ 是来自总体 $N(\mu,\sigma^2)$ 的样本，$\bar{X}, S^2$ 分别是样本均值和样本方差，则有

1. 

$$
\frac{(n-1)S^2}{\sigma^2}\sim{\chi^2(n-1)}
$$

2. 

$\bar{X}$ 与 $S^2$ 相互独立

**定理三 **

设 $X_1,X_2,...,X_n$ 是来自总体 $N(\mu,\sigma^2)$ 的样本，$\bar{X},S^2$ 分别是样本均值和样本方差，则有
$$
\frac{\bar{X}-\mu}{S/\sqrt{n}}\sim{t(n-1)}
$$

**定理四 **

设 $X_1,X_2,...,X_{n_1}$ 与 $Y_1,Y_2,...,Y_{n_2}$ 分别来自正态总体 $N(\mu_1,\sigma_1^2)$ 和 $N(\mu_2,\sigma_2^2)$ 的样本，且这两个样本相互独立。设 $\bar{X} = \frac{1}{n_1}{\sum_{i=1}^{n}{X_i}}, \bar{Y}=\frac{1}{n_2}{\sum_{i=1}^{n}{Y_i}}$ 分别是这两个样本的样本均值；$S_1^2=\frac{1}{n_1-1}{\sum_{i=1}^{n_1}{(X_i-\bar{X})^2}},S_2^2=\frac{1}{n_2-1}{\sum_{i=1}^{n_1}{(Y_i-\bar{Y})^2}}$ 分别是这两个样本的样本方差，则有

1. 

$$
\frac{S_1^2/S_2^2}{\sigma_1^2/\sigma_2^2}\sim{F(n_1-1,n_2-1)};\\
$$

2. 

当 $\sigma_1^2=\sigma_2^2=\sigma^2$ 时，
$$
\frac{(\bar{X}-\bar{Y})-(\mu_1-\mu_2)}{S_w\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}}\sim{t(n_1+n_2-2)}
$$
其中
$$
S_w^2 = \frac{(n_1-1)S_1^2+(n_2-1)S_2^2}{n_1+n_2-2}, S_w=\sqrt{S_w^2}
$$
