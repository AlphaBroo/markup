# 类和控件库
## 基础

### 程序集

程序集是.NET用于部署和配置单元的术语，一个.NET应用程序包括一个或多个程序集，当C#源代码经过编译之后生成的`.dll或.exe`文件，生成的模块会被打包成一个程序集。

在程序集中包含的主要内容是源代码编译后生成的IL(中间语言)，都不能在机器上直接显示，需要.NET框架的运行时环境。另外，程序集中还包含元数据和程序集清单。

元数据描述了程序集中定义的所有类型及其成员的信息，类型可以是类、结构、枚举等，成员主要是方法、属性、事件和字段等。程序集清单记录了程序集所使用的其他程序集的信息、程序集的版本号及版权信息等。

### 类库

类库是一个面向对象的可重用类型集合，这些类型包括接口和类。类库可以解决一系列常见编程任务和多种专用开发任务。

类库、程序集和命名空间关系如下

```
一个类库对应一个程序集，程序集是从文件的物理存储和运行管理来说的，类库是从文件的功能组成角度说的。
命名空间是一种为了组织程序结构而定义的逻辑划分。一个程序集(类库)中可以包含多个命名空间，一个命名空间也可以分布在多个程序集(类库)上。
```

### 组件和控件

在.NET中，组件是指实现`System.ComponentModel.Component`接口的类，或从实现`IComponent`的类中直接或间接派生的类。在软件开发中，组件是🈯️可重复使用并且可以和其他对象进行交互的对象。

控件是组件的一种，它具有组件的所有特性，控件主要是指提供或实现了用户界面功能的组件。在`Windows`窗体控件中，.NET框架为控件提供的基类是`System.Windows.Forms.Control`。

## 自定义类库

- 创建

步骤

```
1. 创建基于类库模版的项目
2. 在项目中添加类或结构等的定义
3. 添加类或结构的方法、属性、事件和字段等
4. 编译类库，一般生成DLL文件
```

- 引用

步骤

```
1. 新建应用程序，在解决方案资源管理器中右键单击引用，选择添加引用
2. 单击浏览，选择自定义类库的位置，把库文件引入到项目
3. 在代码中调用使用
```

## 自定义控件库

自定组件分为三种

```
1. 复合控件
2. 扩展控件
3. 自定义控件
```

- 复合控件

步骤

```c#
// 创建
1. 新建一个windows窗体控件库项目
2. 复合控件外观设计
3. 点击生成菜单，选择生成解决方案，生成复合控件，以dll文件形式存在
// 引用
1. 新建windows窗体应用程序
2. 在项目中新建一个DLL文件夹，把创建的复合控件DLL复制到此文件夹中
3. 在工具箱中右击，选择选择项，打开选择工具箱项对话框
4. 选中.NET Framework组件选项卡，单击浏览按钮找到DLL文件夹下的复合控件DLL文件，单击打开、确定，就在工具箱中引入此控件
5. 使用鼠标将复合控件拖到窗体上，进行设计使用
```

- 扩展控件

步骤

```c#
// 创建
1. 新建一个windows窗体控件库项目，产生一个界面
2. 更改控件的属性、方法、事件
3. 点击生成菜单，选择生成解决方案，生成扩展控件，以dll文件形式存在
4. 为控件添加图标：在解决方案资源管理器中右击该控件项目，单击添加新项，在模版中选择位图文件，更改名字为类名字一致。单击打开，更改此位图的相关属性，将其生成操作属性更改为嵌入的资源
// 引用
与复合控件类似
```

- 自定义控件

步骤

```c#
// 创建
1. 新建一个类库项目，要设计自定义口感你家爱你的外观，引入SystemWindows.Forms程序集
2. 重写OnPaint事件，绘制用户界面
3. 单击生成菜单，选择生成解决方案
// 使用
与复合控件类似
```

