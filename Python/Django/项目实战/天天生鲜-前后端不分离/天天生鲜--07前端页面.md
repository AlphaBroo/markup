# Template

## 基础模版

`template/base.html`

```html
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	{% load staticfiles %}
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>{% block title %}{% endblock %}</title>
	<link rel="stylesheet" type="text/css" href="{% static 'css/reset.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
	<script type="text/javascript" src="{% static 'js/jquery-1.12.4.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/jquery-ui.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/slide.js' %}"></script>
</head>
<body>
	<div class="header_con">
		<div class="header">
			<div class="welcome fl">欢迎来到天天生鲜!</div>
			<div class="fr">
				{% if user.is_authenticated %}
				<div class="login_btn fl">
					欢迎您：<em>{{ user.username }}</em>
					<span>|</span>
					<a href="{% url 'users:logout' %}">退出</a>
				</div>
				{% else %}
				<div class="login_btn fl">
					<a href="{% url 'users:login' %}">登录</a>
					<span>|</span>
					<a href="{% url 'users:register' %}">注册</a>
				</div>
				{% endif %}
				<div class="user_link fl">
					<span>|</span>
					<a href="{% url 'users:info' %}">用户中心</a>
					<span>|</span>
					<a href="{% url 'carts:info' %}">我的购物车</a>
					<span>|</span>
					<a href="{% url 'orders:info' 1 %}">我的订单</a>
				</div>
			</div>
		</div>		
	</div>

	{% block top %}
	<div class="search_bar clearfix">
		<a href="{% url 'goods:index' %}" class="logo fl"><img src="{% static 'images/logo.png' %}"></a>
		<div class="search_con fl">
			<form method="get" action="/search/">
				<input type="text" class="input_text fl" name="q" placeholder="搜索商品">
				<input type="submit" class="input_btn fr" value="搜索">
			</form>
		</div>
		<div class="guest_cart fr">
			<a href="{% url 'carts:info' %}" class="cart_name fl">我的购物车</a>
			<div class="goods_count fl" id="show_count">{{ cart_num }}</div>
		</div>
	</div>
	{% endblock %}

	{% block body %}
	{% endblock %}


	<div class="footer">
		<div class="foot_link">
			<a href="#">关于我们</a>
			<span>|</span>
			<a href="#">联系我们</a>
			<span>|</span>
			<a href="#">招聘人才</a>
			<span>|</span>
			<a href="#">友情链接</a>		
		</div>
		<p>CopyRight © 2016 北京天天生鲜信息技术有限公司 All Rights Reserved</p>
		<p>电话：010-****888    京ICP备*******8号</p>
	</div>
	{% block bottom %}
	<script type="text/javascript" src="{% static 'js/slideshow.js' %}"></script>
	{% endblock %}
</body>
</html>
```

## 登录模版

`template/login.html`

```html
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>天天生鲜-登录</title>
	<link rel="stylesheet" type="text/css" href="../static/css/reset.css">
	<link rel="stylesheet" type="text/css" href="../static/css/main.css">
</head>
<body>
	<div class="login_top clearfix">
		<a href="../static/index.html" class="login_logo"><img src="../static/images/logo02.png"></a>
	</div>

	<div class="login_form_bg">
		<div class="login_form_wrap clearfix">
			<div class="login_banner fl"></div>
			<div class="slogan fl">日夜兼程 · 急速送达</div>
			<div class="login_form fr">
				<div class="login_title clearfix">
					<h1>用户登录</h1>
					<a href="#">立即注册</a>
				</div>
				<div class="form_input">
					<form method="post">
						{% csrf_token %}
						<input type="text" name="username" class="name_input" placeholder="请输入用户名">
						<div class="user_error">输入错误</div>
						<input type="password" name="pwd" class="pass_input" placeholder="请输入密码">
						<div class="pwd_error">输入错误</div>
						<div class="more_input clearfix">
							<input type="checkbox" name="remember">
							<label>记住用户名</label>
						</div>
						<input type="submit" name="" value="登录" class="input_submit">
					</form>
				</div>
                <p>{{ errmsg }}</p>
			</div>
		</div>
	</div>

	<div class="footer no-mp">
		<div class="foot_link">
			<a href="#">关于我们</a>
			<span>|</span>
			<a href="#">联系我们</a>
			<span>|</span>
			<a href="#">招聘人才</a>
			<span>|</span>
			<a href="#">友情链接</a>
		</div>
		<p>CopyRight © 2016 北京天天生鲜信息技术有限公司 All Rights Reserved</p>
		<p>电话：010-****888    京ICP备*******8号</p>
	</div>

</body>
</html>
```

## 注册模版

`template/register.html`

```html
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
{% load staticfiles %}
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>天天生鲜-注册</title>
	<link rel="stylesheet" type="text/css" href="../static/css/reset.css">
	<link rel="stylesheet" type="text/css" href="../static/css/main.css">
	<script type="text/javascript" src="../static/js/jquery-1.12.4.min.js"></script>
	<script type="text/javascript" src="../static/js/register.js"></script>
</head>
<body>
	<div class="register_con">
		<div class="l_con fl">
			<a class="reg_logo"><img src="{% static 'images/logo02.png' %}"></a>
			<div class="reg_slogan">足不出户  ·  新鲜每一天</div>
			<div class="reg_banner"></div>
		</div>

		<div class="r_con fr">
			<div class="reg_title clearfix">
				<h1>用户注册</h1>
				<a href="#">登录</a>
			</div>
			<div class="reg_form clearfix">
				<form method="post">
				{% csrf_token %}
					<ul>
					<li>
						<label>用户名:</label>
						<input type="text" name="user_name" id="user_name">
						<span class="error_tip">提示信息</span>
					</li>					
					<li>
						<label>密码:</label>
						<input type="password" name="pwd" id="pwd">
						<span class="error_tip">提示信息</span>
					</li>
					<li>
						<label>确认密码:</label>
						<input type="password" name="cpwd" id="cpwd">
						<span class="error_tip">提示信息</span>
					</li>
					<li>
						<label>邮箱:</label>
						<input type="text" name="email" id="email">
						<span class="error_tip">提示信息</span>
					</li>
					<li class="agreement">
						<input type="checkbox" name="allow" id="allow" checked="checked">
						<label>同意”天天生鲜用户使用协议“</label>
						<span class="error_tip2">提示信息</span>
					</li>
					<li class="reg_sub">
						<input type="submit" value="注 册" name="">
					</li>
				</ul>				
				</form>
				{{ errmsg }}
			</div>

		</div>

	</div>

	<div class="footer no-mp">
		<div class="foot_link">
			<a href="#">关于我们</a>
			<span>|</span>
			<a href="#">联系我们</a>
			<span>|</span>
			<a href="#">招聘人才</a>
			<span>|</span>
			<a href="#">友情链接</a>		
		</div>
		<p>CopyRight © 2016 北京天天生鲜信息技术有限公司 All Rights Reserved</p>
		<p>电话：010-****888    京ICP备*******8号</p>
	</div>
	
</body>
</html>
```

## 首页-静态

`template/index_for_static`

```html
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	{% load staticfiles %}
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>天天生鲜-首页</title>
	<link rel="stylesheet" type="text/css" href="{% static 'css/reset.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
	<script type="text/javascript" src="{% static 'js/jquery-1.12.4.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/jquery-ui.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/slide.js' %}"></script>
</head>
<body>
	<div class="header_con">
		<div class="header">
			<div class="welcome fl">欢迎来到天天生鲜!</div>
			<div class="fr">
				<div class="login_btn fl">
					<a href="{% url 'users:login' %}">登录</a>
					<span>|</span>
					<a href="{% url 'users:register' %}">注册</a>
				</div>
				<div class="user_link fl">
					<span>|</span>
					<a href="user_center_info.html">用户中心</a>
					<span>|</span>
					<a href="cart.html">我的购物车</a>
					<span>|</span>
					<a href="user_center_order.html">我的订单</a>
				</div>
			</div>
		</div>
	</div>

	<div class="search_bar clearfix">
		<a href="index.html" class="logo fl"><img src="{% static 'images/logo.png' %}"></a>
		<div class="search_con fl">
			<input type="text" class="input_text fl" name="" placeholder="搜索商品">
			<input type="button" class="input_btn fr" name="" value="搜索">
		</div>
		<div class="guest_cart fr">
			<a href="#" class="cart_name fl">我的购物车</a>
			<div class="goods_count fl" id="show_count">0</div>
		</div>
	</div>

	<div class="navbar_con">
		<div class="navbar">
			<h1 class="fl">全部商品分类</h1>
			<ul class="navlist fl">
				<li><a href="">首页</a></li>
				<li class="interval">|</li>
				<li><a href="">手机生鲜</a></li>
				<li class="interval">|</li>
				<li><a href="">抽奖</a></li>
			</ul>
		</div>
	</div>

	<div class="center_con clearfix">
		<ul class="subnav fl">
			{% for category in categories %}
			<li><a href="#model01" class="{{ category.logo }}">{{ category.name }}</a></li>
			{% endfor %}
		</ul>
		<div class="slide fl">
			<ul class="slide_pics">
				{% for goods_banner in index_goods_banners %}
				<li><img src="{{ goods_banner.image.url }}" alt="幻灯片"></li>
				{% endfor %}
			</ul>
			<div class="prev"></div>
			<div class="next"></div>
			<ul class="points"></ul>
		</div>
		<div class="adv fl">
			{% for banner in promotion_banners %}
			<a href="#"><img src="{{ banner.image.url }}"></a>
			{% endfor %}
		</div>
	</div>

	{% for category in categories %}
	<div class="list_model">
		<div class="list_title clearfix">
			<h3 class="fl" id="model01">{{ category.name }}</h3>
			<div class="subtitle fl">
				<span>|</span>
				{% for banner in category.title_banners %}
				<a href="#">{{ banner.sku.name }}</a>
				{% endfor %}
			</div>
			<a href="#" class="goods_more fr" id="fruit_more">查看更多 ></a>
		</div>

		<div class="goods_con clearfix">
			<div class="goods_banner fl"><img src="{{ category.image.url }}"></div>
			<ul class="goods_list fl">
				{% for banner in category.image_banners %}
				<li>
					<h4><a href="#">{{ banner.sku.name }}</a></h4>
					<a href="#"><img src="{{ banner.sku.default_image.url }}"></a>
					<div class="prize">¥ {{ banner.sku.price }}</div>
				</li>
				{% endfor %}
			</ul>
		</div>
	</div>
	{% endfor %}


	<div class="footer">
		<div class="foot_link">
			<a href="#">关于我们</a>
			<span>|</span>
			<a href="#">联系我们</a>
			<span>|</span>
			<a href="#">招聘人才</a>
			<span>|</span>
			<a href="#">友情链接</a>
		</div>
		<p>CopyRight © 2016 北京天天生鲜信息技术有限公司 All Rights Reserved</p>
		<p>电话：010-****888    京ICP备*******8号</p>
	</div>
	<script type="text/javascript" src="{% static 'js/slideshow.js' %}"></script>
	<script type="text/javascript">
		BCSlideshow('focuspic');
		var oFruit = document.getElementById('fruit_more');
		var oShownum = document.getElementById('show_count');

		var hasorder = localStorage.getItem('order_finish');

		if(hasorder)
		{
			oShownum.innerHTML = '2';
		}

		oFruit.onclick = function(){
			window.location.href = 'list.html';
		}
	</script>
</body>
</html>
```

## 首页

`template/index.html`

```html
{% extends "base.html" %}
{% block title %} 天天生鲜-首页 {% endblock %}


{% block body %}
	<div class="navbar_con">
		<div class="navbar">
			<h1 class="fl">全部商品分类</h1>
			<ul class="navlist fl">
				<li><a href="">首页</a></li>
				<li class="interval">|</li>
				<li><a href="">手机生鲜</a></li>
				<li class="interval">|</li>
				<li><a href="">抽奖</a></li>
			</ul>
		</div>
	</div>

	<div class="center_con clearfix">
		<ul class="subnav fl">
			{% for category in categories %}
			<li><a href="#model01" class="{{ category.logo }}">{{ category.name }}</a></li>
			{% endfor %}
		</ul>
		<div class="slide fl">
			<ul class="slide_pics">
				{% for goods_banner in index_goods_banners %}
				<li><img src="{{ goods_banner.image.url }}" alt="幻灯片"></li>
				{% endfor %}
			</ul>
			<div class="prev"></div>
			<div class="next"></div>
			<ul class="points"></ul>
		</div>
		<div class="adv fl">
			{% for banner in promotion_banners %}
			<a href="#"><img src="{{ banner.image.url }}"></a>
			{% endfor %}
		</div>
	</div>

	{% for category in categories %}
	<div class="list_model">
		<div class="list_title clearfix">
			<h3 class="fl" id="model01">{{ category.name }}</h3>
			<div class="subtitle fl">
				<span>|</span>
				{% for banner in category.title_banners %}
				<a href="{% url 'goods:detail' banner.sku.id %}">{{ banner.sku.name }}</a>
				{% endfor %}
			</div>
			<a href="#" class="goods_more fr" id="fruit_more">查看更多 ></a>
		</div>

		<div class="goods_con clearfix">
			<div class="goods_banner fl"><img src="{{ category.image.url }}"></div>
			<ul class="goods_list fl">
				{% for banner in category.image_banners %}
				<li>
					<h4><a href="{% url 'goods:detail' banner.sku.id %}">{{ banner.sku.name }}</a></h4>
					<a href="{% url 'goods:detail' banner.sku.id %}"><img src="{{ banner.sku.default_image.url }}"></a>
					<div class="prize">¥ {{ banner.sku.price }}</div>
				</li>
				{% endfor %}
			</ul>
		</div>
	</div>
	{% endfor %}

{% endblock %}
```

## 商品列表

`template/list.html`

```html
{% extends "base.html" %}

{% block title %}天天生鲜-商品列表{% endblock %}

{% block body %}
	<div class="navbar_con">
		<div class="navbar clearfix">
			<div class="subnav_con fl">
				<h1>全部商品分类</h1>	
				<span></span>			
				<ul class="subnav">
					{% for category in categories %}
					<li><a href="{% url 'goods:list' category.id 1 %}" class="{{ category.logo }}">{{ category.name }}</a></li>
					{% endfor %}
				</ul>
			</div>
			<ul class="navlist fl">
				<li><a href="">首页</a></li>
				<li class="interval">|</li>
				<li><a href="">手机生鲜</a></li>
				<li class="interval">|</li>
				<li><a href="">抽奖</a></li>
			</ul>
		</div>
	</div>

	<div class="breadcrumb">
		<a href="{% url 'goods:index' %}">全部分类</a>
		<span>></span>
		<a href="{% url 'goods:list' category.id 1%}">{{ category.name }}</a>
	</div>

	<div class="main_wrap clearfix">
		<div class="l_wrap fl clearfix">
			<div class="new_goods">
				<h3>新品推荐</h3>
				<ul>
					{% for sku in new_skus %}
					<li>
						<a href="{% url 'goods:detail' sku.id %}"><img src="{{ sku.default_image.url}}"></a>
						<h4><a href="{% url 'goods:detail' sku.id %}">{{ sku.name }}</a></h4>
						<div class="prize">￥{{sku.price}}</div>
					</li>
					{% endfor %}
				</ul>
			</div>
		</div>

		<div class="r_wrap fr clearfix">
			<div class="sort_bar">
				<a href="{% url 'goods:list' category.id 1 %}" {% if sort == "default" %}class="active"{% endif %}>默认</a>
				<a href="{% url 'goods:list' category.id 1 %}?sort=price" {% if sort == "price" %}class="active"{% endif %}>价格</a>
				<a href="{% url 'goods:list' category.id 1 %}?sort=hot" {% if sort == "hot" %}class="active"{% endif %}>人气</a>
			</div>

			<ul class="goods_type_list clearfix">
				{% for sku in page_skus %}
				<li>
					<a href="{% url 'goods:detail' sku.id %}"><img src="{{ sku.default_image.url }}"></a>
					<h4><a href="{% url 'goods:detail' sku.id %}">{{ sku.name }}</a></h4>
					<div class="operate">
						<span class="prize">￥{{ sku.price }}</span>
						<span class="unit">{{ sku.price }}/{{ sku.unit }}</span>
						<a href="#" class="add_goods" title="加入购物车"></a>
					</div>
				</li>
				{% endfor %}

			</ul>

			<div class="pagenation">
				{% if page_skus.has_previous %}
				<a href="{% url 'goods:list' category.id page_skus.previous_page_number %}?sort={{ sort }}">上一页</a>
				{% endif %}

				{% for num in page_nums %}
				<a href="{% url 'goods:list' category.id num %}?sort={{ sort }}" {% if num == page_skus.number %}class="active"{% endif %}>{{ num }}</a>
				{% endfor %}


				{% if page_skus.has_next %}
				<a href="{% url 'goods:list' category.id page_skus.next_page_number %}?sort={{ sort }}">下一页></a>
                {% endif %}
			</div>
		</div>
	</div>

{% endblock %}
```

## 商品详情

`template/detail.html`

```python
{% extends 'base.html' %}
{% load staticfiles %}

{% block title %}天天生鲜-商品详情{% endblock %}

{% block body %}
	<div class="navbar_con">
		<div class="navbar clearfix">
			<div class="subnav_con fl">
				<h1>全部商品分类</h1>
				<span></span>
				<ul class="subnav">
                    {% for category in categories %}
                    <li><a href="#" class="{{ category.logo }}">{{ category.name }}</a></li>
                    {% endfor %}
				</ul>
			</div>
		</div>
	</div>

	<div class="breadcrumb">
		<a href="/">全部分类</a>
		<span>></span>
		<a href="#">{{ sku.category.name }}</a>
		<span>></span>
		<a href="#">商品详情</a>
	</div>

	<div class="goods_detail_con clearfix">
		<div class="goods_detail_pic fl"><img src="{{ sku.default_image.url }}"></div>

		<div class="goods_detail_list fr">
			<h3>{{ sku.name}}</h3>
			<p>{{ sku.title }}</p>
			<div class="prize_bar">
				<span class="show_pirze">¥<em>{{ sku.price }}</em></span>
				<span class="show_unit">单  位：{{ sku.unit }}</span>
			</div>
            {% if other_skus %}
            <div>
                <p>其他规格:</p>
                <ul>
                    {% for sku in other_skus %}
                        <li><a href="{% url 'goods:detail' sku.id %}">{{ sku.price }}/{{ sku.unit }}</a></li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
            <form method="post" action="{% url 'orders:place' %}">
			<div class="goods_num clearfix">
				<div class="num_name fl">数 量：</div>
				<div class="num_add fl">
                    {% csrf_token %}
                    <input type="hidden" name="sku_ids" value="{{ sku.id }}">
					<input type="text" class="num_show fl" name="count" id="num_show" value="1">
					<a href="javascript:;" class="add fr" id="add">+</a>
					<a href="javascript:;" class="minus fr" id="minus">-</a>
				</div>
			</div>
			<div class="total">总价：<em>{{ sku.price }}</em>元</div>
			<div class="operate_btn">
				<input type="submit" class="buy_btn" id="buy_btn" value="立即购买">立即购买</input>
				<a href="javascript:;" class="add_cart" sku_id="{{ sku.id }}" id="add_cart">加入购物车</a>
			</div>
            </form>
		</div>
	</div>

	<div class="main_wrap clearfix">
		<div class="l_wrap fl clearfix">
			<div class="new_goods">
				<h3>新品推荐</h3>
				<ul>
					{% for sku in new_skus %}
					<li>
						<a href="{% url 'goods:detail' sku.id %}"><img src="{{ sku.default_image.url }}"></a>
						<h4><a href="{% url 'goods:detail' sku.id %}">{{ sku.name }}</a></h4>
						<div class="prize">￥{{ sku.price }}</div>
					</li>
					{% endfor %}
				</ul>
			</div>
		</div>

		<div class="r_wrap fr clearfix">
			<ul class="detail_tab clearfix">
				<li id="tag_detail" class="active">商品介绍</li>
				<li id="tag_comment">评论</li>
			</ul>

			<div class="tab_content" id="tab_detail">
				<dl>
					<dt>商品详情：</dt>
					<dd>{{ sku.goods.desc|safe }}</dd>
				</dl>
			</div>

			<div class="tab_content" id="tab_comment" style="display: none;">
				{% for order_goods in order_goods_li %}
				<dl>
					<dd>客户：{{ order_goods.order.user.username  }}&nbsp;&nbsp;&nbsp;时间：{{ order_goods.update_time }}</dd>
					<dt>{{ order_goods.comment }}</dt>
				</dl>
				<hr/>
				{% endfor %}
			</div>

		</div>
	</div>
{% endblock %}

{% block bottom %}
	<div class="add_jump"></div>
	<script type="text/javascript" src="{% static 'js/slide.js' %}"></script>
	<script type="text/javascript">
		$("#tag_detail").click(function(){
			$("#tag_comment").removeClass("active");
			$(this).addClass("active");
			$("#tab_comment").hide();
			$("#tab_detail").show();
		});

		$("#tag_comment").click(function(){
			$("#tag_detail").removeClass("active");
			$(this).addClass("active");
			$("#tab_detail").hide();
			$("#tab_comment").show();
		});

		var $add_x = $('#add_cart').offset().top;
		var $add_y = $('#add_cart').offset().left;

		var $to_x = $('#show_count').offset().top;
		var $to_y = $('#show_count').offset().left;

		$(".add_jump").css({'left':$add_y+80,'top':$add_x+10,'display':'block'})

		$("#add_cart").click(function () {
            // 向后端视图发送请求，让后端保存购物车数据
            // attr(属性名，属性值) 设置
            // attr(属性名） 获取
            var data = {
                sku_id: $(this).attr("sku_id"),
                sku_count: $("#num_show").val(),
                csrfmiddlewaretoken: '{{ csrf_token }}'
            };
            $.post("/carts/add", data, function (resp) {
                // resp 是被ajax解析json字符串执行后的对象（字典）
                // resp.code
                // resp.errmsg
                if (resp.code == 0) {
                    // 后端保存购物车数据成功
                    $(".add_jump").stop().animate({
                            'left': $to_y + 7,
                            'top': $to_x + 7
                        },
                        "fast", function () {
                            $(".add_jump").fadeOut('fast', function () {
                                $('#show_count').html(resp.cart_num);
                            });
                        });

                } else {
                    alert(resp.errmsg);
                }
            }, 'json')
        });

		$("#add").click(function () {
			var num_show = $("#num_show").val();
			num_show = parseInt(num_show)
			num_show += 1;
			$("#num_show").val(num_show);
			var price = $(".show_pirze>em").html()
			price = parseFloat(price);
			var total = price * num_show;
			$(".total>em").html(total.toFixed(2));
		});
		$("#minus").click(function () {
			var num_show = $("#num_show").val();
			num_show = parseInt(num_show)
			num_show -= 1;
			if (num_show < 1) {
				num_show = 1;
			}
			$("#num_show").val(num_show);
			var price = $(".show_pirze>em").html()
			price = parseFloat(price);
			var total = price * num_show;
			$(".total>em").html(total.toFixed(2));
		});
	</script>
{% endblock %}
```

## 搜索

`template/search/search.html`

```html
{% extends 'base.html' %}

{% load staticfiles %}

{% block title %}天天生鲜-搜索结果{% endblock %}

{% block top %}
    <div class="search_bar clearfix">
        <a href="{% url 'goods:index' %}" class="logo fl"><img src="{% static 'images/logo.png' %}"></a>
        <div class="sub_page_name fl">|&nbsp;&nbsp;&nbsp;&nbsp;搜索结果</div>
        <div class="search_con fr">
            <form action="/search/" method="get">
            <input type="text" class="input_text fl" name="q" placeholder="搜索商品">
            <input type="submit" class="input_btn fr" value="搜索">
            </form>
        </div>
    </div>
{% endblock %}

{% block body %}
    <div class="main_wrap clearfix">
        <ul class="goods_type_list clearfix">
        {% for result in page %}
            <li>
                <a href="{% url 'goods:detail' result.object.id %}"><img src="{{ result.object.default_image.url }}"></a>
                <h4><a href="{% url 'goods:detail' result.object.id %}">{{result.object.name}}</a></h4>
                <div class="operate">
                    <span class="prize">￥{{ result.object.price }}</span>
                    <span class="unit">{{ result.object.price }}/{{ result.object.unit }}</span>
                </div>
            </li>
        {% empty %}
            <p>没有找到您要查询的商品。</p>
        {% endfor %}
        </ul>

        {% if page.has_previous or page.has_next %}
        <div class="pagenation">
            {% if page.has_previous %}<a href="/search/?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}<上一页{% if page.has_previous %}</a>{% endif %}
            |
            {% if page.has_next %}<a href="/search/?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}下一页>{% if page.has_next %}</a>{% endif %}
        </div>
        {% endif %}
    </div>
{% endblock %}
```

`template/search/indexes/goods/goodssku_text.txt`

```
# 指明在模型类中搜索的字段
{{ object.name }}
{{ object.title }}
```

## 购物车

`template/cart.html`

```html
{% extends 'base.html' %}

{% block title %}天天生鲜-购物车{% endblock %}
{% load staticfiles %}

{% block top %}
	<div class="search_bar clearfix">
		<a href="{% url 'goods:index' %}" class="logo fl"><img src="{% static 'images/logo.png' %}"></a>
		<div class="sub_page_name fl">|&nbsp;&nbsp;&nbsp;&nbsp;购物车</div>
		<div class="search_con fr">
			<form action="/search/" method="get">
            <input type="text" class="input_text fl" name="q" placeholder="搜索商品">
            <input type="submit" class="input_btn fr" value="搜索">
            </form>
		</div>
	</div>
{% endblock %}

{% block body %}
	<div class="total_count">全部商品<em>{{total_count}}</em>件</div>
	<ul class="cart_list_th clearfix">
		<li class="col01">商品名称</li>
		<li class="col02">商品单位</li>
		<li class="col03">商品价格</li>
		<li class="col04">数量</li>
		<li class="col05">小计</li>
		<li class="col06">操作</li>
	</ul>
	<form method="post" action="{% url 'orders:place' %}">
	{% csrf_token %}
	{% for sku in skus %}
	<ul class="cart_list_td clearfix" sku_id="{{ sku.id }}">
		<li class="col01"><input type="checkbox" name="sku_ids" value="{{ sku.id }}" checked></li>
		<li class="col02"><img src="{{ sku.default_image.url }}"></li>
		<li class="col03">{{ sku.name }}<br><em>{{ sku.price }}/{{ sku.unit}}</em></li>
		<li class="col04">{{ sku.unit }}</li>
        <li class="col05"><span>{{sku.price}}</span>元</li>
		<li class="col06">
			<div class="num_add">
				<a href="javascript:;" class="add fl">+</a>
				<input type="text" class="num_show fl" sku_id="{{ sku.id }}" value="{{sku.count}}">
				<a href="javascript:;" class="minus fl">-</a>
			</div>
		</li>
        <li class="col07"><span>{{sku.amount}}</span>元</li>
		<li class="col08"><a href="javascript:;" class="del_btn">删除</a></li>
	</ul>
	{% endfor %}
	<ul class="settlements">
		<li class="col01"><input type="checkbox" checked></li>
		<li class="col02">全选</li>
		<li class="col03">合计(不含运费)：<span>¥</span><em id="total_amount">{{total_amount}}</em><br>共计<b id="total_count">{{total_count}}</b>件商品</li>
		<li class="col04"><input type="submit" id="commit_btn">去结算</input></li>
	</ul>
	</form>


{% endblock %}

{% block bottom %}
	<script type="text/javascript" src="{% static 'js/jquery-1.12.4.min.js' %}"></script>
	<script type="text/javascript">
		// 更新页面合计信息
		function freshOrderCommitInfo() {
			var total_amount = 0;
			var total_count = 0;
            $('.cart_list_td').find(':checked').parents('ul').each(function () {
                var sku_amount = $(this).children('li.col07').text();  // 商品的金额
                var sku_count = $(this).find('.num_show').val()  // 商品的数量
                total_count += parseInt(sku_count);
                total_amount += parseFloat(sku_amount);
            });
			// 设置商品的总数和总价
			$("#total_amount").text(total_amount.toFixed(2));
			$("#total_count").text(total_count);
		}

		// 更新页面顶端全部商品数量
		function freshTotalGoodsCount() {
			var total_count = 0;
            $('.cart_list_td').find(':checkbox').parents('ul').each(function () {
                var sku_count = $(this).find('.num_show').val();
				total_count += parseInt(sku_count);
			});
			$(".total_count>em").text(total_count);
		}

		// 更新后端购物车信息
		function updateRemoteCartInfo(sku_id, sku_count, num_dom) {
		    // 发送给后端的数据
		    var req = {
                sku_id: sku_id,
                sku_count: sku_count,
                csrfmiddlewaretoken: "{{ csrf_token }}"
            };
			$.post("{% url 'carts:update' %}", req, function(data){
				if (0 == data.code) {
                    // 更新商品数量
                    $(num_dom).val(sku_count);
			        // 更新商品金额信息
			        var sku_price = $(".cart_list_td[sku_id="+sku_id+"]").children('li.col05').children().text();
					var sku_amount = parseFloat(sku_price) * sku_count;
                    $(".cart_list_td[sku_id="+sku_id+"]").children('li.col07').children().text(sku_amount.toFixed(2));
                    // 更新顶部商品总数
                    freshTotalGoodsCount();
                    // 更新底部合计信息
					freshOrderCommitInfo();
				} else {
				    alert(data.errmsg);
                }
			}, "json");
		}

		// 增加
		$(".add").click(function(){
		    // 获取操作的商品id
			var sku_id = $(this).next().attr("sku_id");
			// 获取加操作前的的数量
			var sku_num = $(this).next().val();
			// 进行数量加1
			sku_num = parseInt(sku_num);
			sku_num += 1;

			// 显示商品数目的dom
			var num_dom = $(this).next();
            // 更新购物车数量
			updateRemoteCartInfo(sku_id, sku_num, num_dom);
		});

        // 减少
		$(".minus").click(function(){
            // 获取操作的商品id
            var sku_id = $(this).prev().attr("sku_id");
            // 获取加操作前的的数量
            var sku_num = $(this).prev().val();
            // 进行数量加1
			sku_num = parseInt(sku_num);
			sku_num -= 1;
			if (sku_num < 1) sku_num = 1;
            // 更新页面显示数量
            var num_dom = $(this).prev();
            // 更新购物车数量
			updateRemoteCartInfo(sku_id, sku_num, num_dom);
		});

		var pre_sku_count = 0;
        $('.num_show').focus(function () {
            // 记录用户手动输入之前商品数目
            pre_sku_count = $(this).val();
        });
		// 手动输入
		$(".num_show").blur(function(){
			var sku_id = $(this).attr("sku_id");
			var sku_num = $(this).val();
			// 如果输入的数据不合理，则将输入值设置为在手动输入前记录的商品数目
			if (isNaN(sku_num) || sku_num.trim().length<=0 || parseInt(sku_num)<=0) {
                $(this).val(pre_sku_count);
                return;
            }
			sku_num = parseInt(sku_num);
			var num_dom = $(this);
			updateRemoteCartInfo(sku_id, sku_num, num_dom);
		});

		// 删除
		$(".del_btn").click(function(){
			var sku_id = $(this).parents("ul").attr("sku_id");
			var req = {
			    sku_id: sku_id,
                csrfmiddlewaretoken: "{{ csrf_token }}"
            };
			$.post('{% url "carts:delete" %}', req, function(data){
				if (data.code == 0) {
                    {#                window.reload()#}
                    location.href="{% url 'carts:info' %}";  // 删除后，刷新页面
				}
			});
		});

		// 商品对应checkbox发生改变时，全选checkbox发生改变
        $('.cart_list_td').find(':checkbox').change(function () {
            // 获取商品所有checkbox的数目
            var all_len = $('.cart_list_td').find(':checkbox').length;
            // 获取选中商品的checkbox的数目
            var checked_len = $('.cart_list_td').find(':checked').length;

            if (checked_len < all_len){
                // 有商品没有被选中
                $('.settlements').find(':checkbox').prop('checked', false)
            }
            else{
                // 所有商品都被选中
                $('.settlements').find(':checkbox').prop('checked', true)
            }
            freshOrderCommitInfo();
        });

		// 全选和全不选
        $('.settlements').find(':checkbox').change(function () {
            // 1.获取当前checkbox的选中状态
            var is_checked = $(this).prop('checked');
            // 2.遍历并设置商品ul中checkbox的选中状态
            $('.cart_list_td').find(':checkbox').each(function () {
                // 设置每一个goods ul中checkbox的值
                $(this).prop('checked', is_checked)
            });
            freshOrderCommitInfo();
        });

	</script>
{% endblock %}
```

## 提交订单

`template/place_order.html`

```html
{% extends 'base.html' %}

{% load staticfiles %}

{% block title %}天天生鲜-提交订单{% endblock %}

{% block top %}
	<div class="search_bar clearfix">
		<a href="/" class="logo fl"><img src="{% static 'images/logo.png' %}"></a>
		<div class="sub_page_name fl">|&nbsp;&nbsp;&nbsp;&nbsp;提交订单</div>
		<div class="search_con fr">
			<form action="/search/" method="get">
            <input type="text" class="input_text fl" name="q" placeholder="搜索商品">
            <input type="submit" class="input_btn fr" value="搜索">
            </form>
		</div>		
	</div>
{% endblock %}

{% block body %}
	<h3 class="common_title">确认收货地址</h3>

	<div class="common_list_con clearfix">
		<dl>
			<dt>寄送到：</dt>
			{% if address %}
			<dd><input type="radio" name="address_id" value="{{address.id}}" checked="">{{address.receiver_name}} {{address.detail_addr}} {{address.receiver_mobile}}</dd>
			{% else %}
			<dd><input type="radio" name="address_id" value="" checked="">请添加地址</dd>
			{% endif %}
		</dl>
		<a href="{% url 'users:address' %}" class="edit_site">编辑收货地址</a>

	</div>
	
	<h3 class="common_title">支付方式</h3>	
	<div class="common_list_con clearfix">
		<div class="pay_style_con clearfix">
			<input type="radio" name="pay_style" value="1" checked>
			<label class="cash">货到付款</label>
			<input type="radio" name="pay_style" value="2">
			<label class="weixin">微信支付</label>
			<input type="radio" name="pay_style" value="2">
			<label class="zhifubao">支付宝</label>
			<input type="radio" name="pay_style" value="2">
			<label class="bank">银行卡支付</label>
		</div>
	</div>

	<h3 class="common_title">商品列表</h3>
	
	<div class="common_list_con clearfix">
		<ul class="goods_list_th clearfix">
			<li class="col01">商品名称</li>
			<li class="col02">商品单位</li>
			<li class="col03">商品价格</li>
			<li class="col04">数量</li>
			<li class="col05">小计</li>		
		</ul>
		{% for sku in skus %}
		<ul class="goods_list_td clearfix">
			<li class="col01">{{forloop.counter}}</li>			
			<li class="col02"><img src="{{ sku.default_image.url }}"></li>
			<li class="col03">{{sku.name}}</li>
			<li class="col04">{{sku.unit}}</li>
			<li class="col05">{{sku.price}}元</li>
			<li class="col06">{{sku.count}}</li>
			<li class="col07">{{sku.amount}}元</li>
		</ul>
		{% endfor %}
	</div>

	<h3 class="common_title">总金额结算</h3>

	<div class="common_list_con clearfix">
		<div class="settle_con">
			<div class="total_goods_count">共<em>{{total_count}}</em>件商品，总金额<b>{{total_amount}}元</b></div>
			<div class="transit">运费：<b>{{trans_cost}}元</b></div>
			<div class="total_pay">实付款：<b>{{final_amount}}元</b></div>
		</div>
	</div>

	<div class="order_submit clearfix">
		<a href="javascript:;" id="order_btn">提交订单</a>
	</div>
	<div class="popup_con">
		<div class="popup">
			<p>订单提交成功！</p>
		</div>

		<div class="mask"></div>
	</div>
{% endblock %}

{% block bottom %}
	<script type="text/javascript" src="{% static 'js/jquery-1.12.4.min.js' %}"></script>
	<script type="text/javascript">
		$('#order_btn').click(function() {
		    // 地址id
			var address_id = $('input[name="address_id"]').val();
			if (address_id == "") {
				alert("请先编辑收货地址!");
			}
			else {
				var order_data = {
					address_id: address_id,
                    pay_method: $('input[name="pay_style"]:checked').val(),
					sku_ids: "{{ sku_ids }}",
                    csrfmiddlewaretoken: "{{ csrf_token }}"
				};
				$.post('{% url "orders:commit" %}', order_data, function(data){
					if (1 == data.code) {
                        location.href = '{% url "users:login" %}';
                    } else if (6 == data.code) {
						alert("库存不足，请修改订单！");
					} else if (0 == data.code) {
					    // 下单成功
						$('.popup_con').fadeIn('fast', function() {
							setTimeout(function(){
								$('.popup_con').fadeOut('fast',function(){
								    // 调转到用户订单页面
									location.href = '{% url "orders:info" 1 %}';
								});	
							},3000)	
						});
					} else {
					    alert("下单失败，请重试！");
                    }
				}, "json");
			}
		});
	</script>
{% endblock %}
```

## 用户中心基础模版

`template/user_center_base.html`

```html
{% extends "base.html" %}

{% block title %}天天生鲜-用户中心{% endblock %}

{% block top %}
	<div class="search_bar clearfix">
		<a href="{% url 'goods:index' %}" class="logo fl"><img src="../static/images/logo.png"></a>
		<div class="sub_page_name fl">|&nbsp;&nbsp;&nbsp;&nbsp;用户中心</div>
		<div class="search_con fr">
			<input type="text" class="input_text fl" name="" placeholder="搜索商品">
			<input type="button" class="input_btn fr" name="" value="搜索">
		</div>		
	</div>
{% endblock %}
```

## 用户中心信息

`template/user_center_info`

```html
{% extends "user_center_base.html" %}

{% block body %}
	<div class="main_con clearfix">
		<div class="left_menu_con clearfix">
			<h3>用户中心</h3>
			<ul>
				<li><a href="{% url 'users:info' %}" class="active">· 个人信息</a></li>
				<li><a href="{% url 'orders:info' 1 %}">· 全部订单</a></li>
				<li><a href="{% url 'users:address' %}">· 收货地址</a></li>
			</ul>
		</div>
		<div class="right_content clearfix">
				<div class="info_con clearfix">
				<h3 class="common_title2">基本信息</h3>
						<ul class="user_info_list">
							{% if address %}
							<li><span>用户名：</span>{{ address.receiver_name }}</li>
							<li><span>联系方式：</span>{{ address.receiver_mobile }}</li>
							<li><span>联系地址：</span>{{ address.detail_addr }}</li>
							{% endif %}
						</ul>
				</div>
				
				<h3 class="common_title2">最近浏览</h3>
				<div class="has_view_list">
					<ul class="goods_type_list clearfix">
                        {% for sku in skus %}
				<li>
					<a href="detail.html"><img src="{{ sku.default_image.url }}"></a>
					<h4><a href="detail.html">{{ sku.name }}</a></h4>
					<div class="operate">
						<span class="prize">￥{{ sku.price }}</span>
						<span class="unit">{{ sku.price }}/{{ sku.unit }}</span>
						<a href="#" class="add_goods" title="加入购物车"></a>
					</div>
				</li>
					{% endfor %}
			</ul>
		</div>
		</div>
	</div>
{% endblock %}
```

## 用户中心订单

`template/user_center_order.html`

```python
{% extends 'user_center_base.html' %}

{% load staticfiles %}

{% block title %}天天生鲜-用户中心{% endblock %}

{% block body %}
	<div class="main_con clearfix">
		<div class="left_menu_con clearfix">
			<h3>用户中心</h3>
			<ul>
				<li><a href="{% url 'users:info' %}">· 个人信息</a></li>
				<li><a href="{% url 'orders:info' 1 %}" class="active">· 全部订单</a></li>
				<li><a href="{% url 'users:address' %}">· 收货地址</a></li>
			</ul>
		</div>
		<div class="right_content clearfix">
				<h3 class="common_title2">全部订单</h3>
				{% for order in orders %}
				<ul class="order_list_th w978 clearfix">
					<li class="col01">{{order.create_time}}</li>
					<li class="col02">订单号：{{order.order_id}}</li>
					<li class="col02 stress">{{order.status_name}}</li>
				</ul>

				<table class="order_list_table w980">
					<tbody>
						<tr>
							<td width="55%">
								{% for sku in order.skus %}
								<ul class="order_goods_list clearfix">					
									<li class="col01"><img src="{{sku.default_image.url}}"></li>
									<li class="col02">{{sku.name}}<em>{{sku.price}}/{{sku.unit}}</em></li>
									<li class="col03">{{sku.count}}</li>
									<li class="col04">{{sku.amount}}元</li>
								</ul>
								{% endfor %}
							</td>
							<td width="15%">{{order.total_amount}}元<br/>（含运费{{order.trans_cost}}元）</td>
							<td width="15%">{{order.pay_method_name}}</td>
							<td width="15%"><a href="javascript:;" order_id="{{order.order_id}}" order_status="{{order.status}}" class="oper_btn">
                                {{ order.status_name }}
							</a></td>
						</tr>
					</tbody>
				</table>
				{% endfor %}

				<div class="pagenation">
				{% if orders.has_previous %}
					<a href="{% url 'orders:info' orders.previous_page_number %}"><上一页</a>
				{% endif %}
				{% for p in pages %}
					<a href="{% url 'orders:info' p %}" {% if p == order.number %}class="active"{% endif %}>{{p}}</a>
				{% endfor %}
				{% if orders.has_next %}
					<a href="{% url 'orders:info' orders.next_page_number %}">下一页></a>
				{% endif %}
				</div>
		</div>
	</div>
{% endblock %}

{% block bottom %}
	<script type="text/javascript" src="{% static 'js/jquery-1.12.4.min.js' %}"></script>
	<script type="text/javascript">
		$('.oper_btn').click(function() {
			var order_id = $(this).attr("order_id");

			var order_status = $(this).attr("order_status");

			order_status = parseInt(order_status);

			if (1 == order_status) {
			    // 发起支付请求
				var req_data = {
				    order_id: order_id,
					csrfmiddlewaretoken: '{{ csrf_token }}'
				};
				$.post('{% url "orders:pay" %}', req_data, function(data){
                    if ( 1 == data.code ) {
                        location.href = "{% url 'users:login' %}";
                    } else if (0 == data.code ) {
                        // 从后端中获取到了支付宝的支付链接
						// 打开新的标签页，并且跳转到支付宝的页面
                        window.open(data.pay_url);

						// 让后端查询支付结果
                        $.get("{% url 'orders:check_pay' %}?order_id="+order_id, function (resp_data) {
                            if (0 == resp_data.code) {
                                // 支付成功
                                location.reload();
                            } else {
                                alert(resp_data.errmsg);
                            }
                        });
                    } else {
                        alert(data.errmsg);
                    }
				}, "json");
			} else if (4 == order_status) {
			    // 评价
				location.href = ("/orders/comment/" + order_id);
			} 
		});
	</script>
{% endblock %}
```

## 订单评价

`template/user_center_order.html`

```html
{% extends 'user_center_base.html' %}

{% load staticfiles %}

{% block title %}天天生鲜-用户中心{% endblock %}

{% block body %}
    <div class="main_con clearfix">
        <div class="left_menu_con clearfix">
            <h3>用户中心</h3>
            <ul>
				<li><a href="{% url 'users:info' %}">· 个人信息</a></li>
				<li><a href="{% url 'orders:info' 1 %}" class="active">· 全部订单</a></li>
				<li><a href="{% url 'users:address' %}">· 收货地址</a></li>
			</ul>
        </div>
        <div class="right_content clearfix">
            <h3 class="common_title2">订单评价</h3>
                <ul class="order_list_th w978 clearfix">
					<li class="col01">{{order.create_time}}</li>
					<li class="col02">订单号：{{order.order_id}}</li>
					<li class="col02 stress">{{order.status_name}}</li>
				</ul>
            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="order_id" value="{{order.order_id}}">
                <input type="hidden" name="total_count" value="{{order.skus|length}}">
                {% for sku in order.skus %}
                <table class="order_list_table w980">
                    <tbody>
                        <tr>
                            <td width="80%">
                                <ul class="order_goods_list clearfix">
                                    <li class="col01"><img src="{{ sku.default_image.url }}"></li>
                                    <li class="col02">{{sku.name}}<em>{{sku.price}}/{{sku.unit}}</em></li>
                                    <li class="col03">{{sku.count}}</li>
                                </ul>
                            </td>
                            <td width="20%">{{sku.amount}}元</td>
                        </tr>
                    </tbody>
                </table>
                <div class="site_con">
                    <input type="hidden" name="sku_{{forloop.counter}}" value="{{sku.id}}">
                    <div class="form_group form_group2">
                        <label>评价内容：</label>
                        <textarea class="site_area" name="content_{{forloop.counter}}"></textarea>
                    </div>
                </div>
                {% endfor %}
                <input type="submit" name="" value="提交" class="info_submit">
            </form>
        </div>
    </div>
{% endblock %}
```

## 用户中心地图

`template/user_center_site.html`

```html
{% extends "user_center_base.html" %}

{% block body %}
	<div class="main_con clearfix">
		<div class="left_menu_con clearfix">
			<h3>用户中心</h3>
			<ul>
				<li><a href="{% url 'users:info' %}">· 个人信息</a></li>
				<li><a href="{% url 'orders:info' 1 %}">· 全部订单</a></li>
				<li><a href="{% url 'users:address' %}" class="active">· 收货地址</a></li>
			</ul>
		</div>
        <div class="right_content clearfix">
            <h3 class="common_title2">收货地址</h3>
            <div class="site_con">
                <dl>
                    <dt>当前地址：</dt>
                    {% if address %}
                    <dd>{{ address.detail_addr }} 邮编：{{ address.zip_code}} （{{ address.receiver_name}} 收） {{ address.receiver_mobile}}</dd>
                    {% else %}
                    <dd></dd>
                    {% endif %}
                </dl>
            </div>
            <h3 class="common_title2">编辑地址</h3>
            <div class="site_con">
                <form method="post">
                    {% csrf_token %}
                    <div class="form_group">
                        <label>收件人：</label>
                        <input type="text" name="receiver_name">
                    </div>
                    <div class="form_group form_group2">
                        <label>详细地址：</label>
                        <textarea class="site_area" name="address"></textarea>
                    </div>
                    <div class="form_group">
                        <label>邮编：</label>
                        <input type="text" name="zip_code">
                    </div>
                    <div class="form_group">
                        <label>手机：</label>
                        <input type="text" name="mobile">
                    </div>

                    <input type="submit" name="" value="提交" class="info_submit">
                </form>
            </div>
        </div>
	</div>

{% endblock %}
```

