# # 数据导入

- csv

```python
import csv
import sys


fileName = 'data/ch02-data.csv'
data = []
try:
    with open(fileName) as f:
        reader = csv.reader(f)
        header = next(reader)
        data = [row for row in reader]
except csv.Error as e:
    print("读取csv文件错误所在行:%s,错误内容:%s" % (reader.line_num,e))
    sys.exit(-1)

if header:
    print(header)
    print("=========")
for datarow in data:
    print(datarow)
```

注意：

> 加载大数据文件可使用

```python
# 速度快
numpy.loadtxt('ch02-data.csv', dtype = 'string', delimiter=',')
# 速读稍慢，但更好地处理缺失数据
numpy.genformtxt()
```

- excel

```python
import xlrd


file = 'data/ch02-xlsxdata.xlsx'
# 读取xlsx文件，创建xlrd_book实例
wb = xlrd.open_workbook(filename=file)
# 通过表名获取工作表
# ws = wb.sheet_by_name('Sheet1')
# 通过索引获得工作表
ws = wb.sheet_by_index(0)
dataSet = []

for r in range(ws.nrows):
    col = []
    for c in range(ws.ncols):
        col.append(ws.cell(r, c).value)
    dataSet.append(col)

# 美观打印数据结构
from pprint import pprint
pprint(dataSet)
```

- 定宽数据

事件的日志文件和基于时间序列的文件是数据可是话中最常见的数据源。有时可以以制表符分隔数据这种CSV格式来读取，但有时它们不是通过任何特殊字符来分隔的。实际上，这些文件中的字段是有固定宽度的，可以通过格式来匹配并提取数据

方法一：逐行读取，然后用字符串操作方法把字符串分隔成独立部分。若性能不是问题可以作为优选

方法二：若性能重要或文件较大(几百兆),用python中的struct模块(C实现)能提升性能。

```

```





