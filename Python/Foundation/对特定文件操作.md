# Excel

```shell
# 读Excel文件
pip install xlrd
# 写Excel文件
pip install xlwt
```

## 读取

```python
#coding=utf-8
import xlrd
'''
文件路径比较重要，要以这种方式去写文件路径不用
'''
# 读取的文件路径
file_path = r'd:/功率因数.xlsx'
# 文件中的中文转码
file_path = file_path.decode('utf-8')
# 获取数据
data = xlrd.open_workbook(file_path)

# 获取sheet
# 通过sheet索引
sheet1 = book.sheet_by_index(0)
# 获得指定索引的sheet名
sheet1_name = book.sheet_names()[0]
print(sheet1_name)
# 通过sheet名字获得sheet对象
sheet1 = book.sheet_by_name(sheet1_name)

# 获取总行数
nrows = table.nrows
# 获取总列数
ncols = table.ncols
# 获取一行的数值
table.row_values(i)
# 获取一列的数值
table.col_values(i)

#获取一个单元格的数值
cell_value = table.cell(a,b).value
```

## 写入

```python
# conding:utf-8
import xlwt
# 创建一个Wordbook对象，相当于创建了一个Excel文件
book = xlwt.Workbook(encoding = "utf-8", style_compression = 0)
# 创建一个sheet对象，一个sheet对象对应Excel文件中的一张表格
sheet = book.add_sheet("sheet1", cell_overwrite_ok=True)
# 向表sheet1中添加数据
# 参数(行数，列数， 内容)
sheet.write(0, 0, "EnglishName")
sheet.write(1, 0, "MaYi")
sheet.write(0, 1, "中文名字")
sheet.write(1, 1, "蚂蚁")
# 将以上操作保存到指定的Excel文件中
book.save("name.xls")
```

